DROP TABLE IF EXISTS producers CASCADE;
DROP TABLE IF EXISTS movies CASCADE;
DROP TABLE IF EXISTS actors CASCADE;
DROP TABLE IF EXISTS actors_movies CASCADE;

CREATE TABLE IF NOT EXISTS producers(
    producer_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE,
    age INTEGER CHECK (age > 10)
);

CREATE TABLE IF NOT EXISTS movies(
    movie_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    producer_id INTEGER NOT NULL REFERENCES producers(producer_id),
    name VARCHAR(200) NOT NULL,
    year_of_production INTEGER CHECK(year_of_production > 1900)
);

CREATE TABLE IF NOT EXISTS actors(
    actor_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    age INTEGER CHECK(age > 0)
);

CREATE TABLE IF NOT EXISTS actors_movies(
    actor_id INTEGER REFERENCES actors(actor_id),
    movie_id INTEGER REFERENCES movies(movie_id),
    PRIMARY KEY(actor_id, movie_id)
);